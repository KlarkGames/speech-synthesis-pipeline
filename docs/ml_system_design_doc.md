# ML System Design Document

## Предисловие

Данный проект ведется очень сумбурно. За ~полгода работы с заказчиком я не видел ни одного ТЗ, конкретного требования. Отдельно эта проблема касается нефункциональных требований. Соответственно, некоторые вопросы, по типу скорости модели или критериев оценки качества синтеза, будут опущены, по причине отсутствия ответа со стороны заказчика.

## Содержание

- [ML System Design Document](#ml-system-design-document)
  - [Предисловие](#предисловие)
  - [Содержание](#содержание)
  - [1. Цели и предпосылки](#1-цели-и-предпосылки)
    - [1.1. Бизнес-цели](#11-бизнес-цели)
  - [2. Требования к решению](#2-требования-к-решению)
    - [2.1. Функциональные требования](#21-функциональные-требования)
    - [2.2. Нефункциональные требования](#22-нефункциональные-требования)
    - [2.3. Ограничение ответственности команды разработки](#23-ограничение-ответственности-команды-разработки)
    - [2.4. Блоксхема решения](#24-блоксхема-решения)


## 1. Цели и предпосылки

### 1.1. Бизнес-цели

**Бизнес-цель** - продемонстрировать современность имеющихся в компании технологий и подходов перед заказчиком. Актуализировать технологии. 

Разрабатываемая командой часть проекта является **Emotional Speech Synthesis (Дальше ESS)** модель для озвучки сгенерированных LLM диалогов. Озвучка ожидается "на лету", т.е. нет возможности озвучить диалоги заранее.

У разрабатывающей команды есть наработки в области ESS, данный проект позволит актуализировать имеющиеся подходы и технологии. 

Успешным результатом **с точки зрения заказчика** является разворачиваемая на инфраструктуре заказчика и силами его разработчиков ESS модель. Качество модели должно субъективно удовлетворять представителей заказчика.

Успешным результатом **c точки зрения разрабатывающей команды** является отданный заказчику checkpoint модели и GitLab репозиторий с инструкциями по запуску. Дополнительно упомянутые выше артефакты должны удовлетворять всем оговоренным функциональным и нефункциональным требованиям.

## 2. Требования к решению

### 2.1. Функциональные требования

1. Пользователь должен при имеющихся тексте и идентификаторах голоса и эмоции получить озвучку текста с соответствующими голосом и эмоцией.
2. Пользователь может вместо идентификатора голоса и эмоции дать на вход аудиофайл, содержащий пример требуемого голоса и эмоции. 
3. Команда разработки со стороны заказчика должна иметь возможность запустить Docker контейнер с моделью и чекпоинтом и повторить действия из пункта 1.

### 2.2. Нефункциональные требования

1. На инфраструктуре команды разработчиков разрабатываемый контейнер с моделью должен держать 100 RPS.
2. Текст должен быть представлен без дополнительных тегов (По типу Markdown, HTML), на английском языке в нижнем и верхнем регистре с числами и символами препинания входящими в список **!?.,"'()-`+**
3. Идентификаторы голоса и эмоции ожидаются в виде текстовой строки в нижнем регистре с символами английского алфавита и числами. При отсутствии требуемой эмоции или голоса - контейнер должен вернуть ошибку с перечнем имеющихся эмоций и голосов. 
4. Пример аудио с голосом и эмоцией ожидается с частотой дискретизации 44.1 kHZ с 1 каналом (mono) и Encoding'ом 16-bit Signed Integer PCM.
5. Если входные данные не соответствуют пунктам 2-4, несоответствия должны обрабатываться в контейнере модели. 
6. Возвращаемое аудио так же должно соответствовать пункту 4.
7. Качество синтезируемого аудио должно удовлетворять сторону заказчика. 
8. Синтезируемое аудио должно быть без заметных артефактов, по типу скрежета, писка, робовойса, белого шума.

### 2.3. Ограничение ответственности команды разработки

Команда разработки предоставляет Docker контейнер с моделью и чекпоинты для запуска. Команда разработки вносит изменения в контейнер, если они не удовлетворяют требованиям. Однако команда разработки не отвечает за интеграцию этого контейнера в конечный продукт заказчика. 

Команда разработки может настоять на проведение Mean Opinion Score теста (MOS) для объективной оценки качества синтеза голоса в случаях разногласий в субъективной оценки результатов. 

Команда разработки не предоставляет заказчику информацию о дополнительных данных, используемых для обучения, и о методах/пайплайнах обработки и обучения.

### 2.4. Блоксхема решения

![alt text](<images/Model Workflow.drawio.png>)
